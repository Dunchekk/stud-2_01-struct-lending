(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const p of n)if(p.type==="childList")for(const u of p.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function f(n){const p={};return n.integrity&&(p.integrity=n.integrity),n.referrerPolicy&&(p.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?p.credentials="include":n.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function l(n){if(n.ep)return;n.ep=!0;const p=f(n);fetch(n.href,p)}})();function ae(){const e=document.getElementById("pixi-container-waves-blur"),t=document.getElementById("main-field-wrapper"),f=document.getElementById("main-field");let l=null;const n=new PIXI.Application({resizeTo:e,backgroundAlpha:0,antialias:!0});e.appendChild(n.view),n.ticker.maxFPS=45;const p=new PIXI.Container;n.stage.addChild(p);const u=j("media/background/wod2_safari.mp4"),o=j("media/background/wod2.webm"),s=document.createElement("video");s.crossOrigin="anonymous",s.muted=!0,s.loop=!0,s.autoplay=!0,s.playsInline=!0,s.setAttribute("playsinline",""),s.preload="auto";const r=document.createElement("source");r.src=u,r.type="video/mp4";const i=document.createElement("source");i.src=o,i.type="video/webm",s.append(r,i);const g=()=>s.play().catch(()=>{});s.addEventListener("canplay",g,{once:!0}),window.addEventListener("pointerdown",g,{once:!0});const v=PIXI.Texture.from(s),w=new PIXI.Sprite(v),L=1.4;w.anchor.set(.5);function M(){const S=s&&s.videoWidth||w.texture.width||1920,h=s&&s.videoHeight||w.texture.height||1080,y=Math.max(n.screen.width/S,n.screen.height/h)*L;w.scale.set(y),w.x=n.screen.width/2,w.y=n.screen.height/2,l&&(l.scale.set(y),l.x=w.x,l.y=w.y)}const A=()=>M();s.readyState>=1?A():s.addEventListener("loadedmetadata",A,{once:!0}),p.addChildAt(w,0);const B=/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent),d=window.devicePixelRatio>2||n.screen.width<800;if(!B&&!d){l=new PIXI.Sprite(w.texture),l.anchor.set(.5);const y=new PIXI.BlurFilter;y.blur=6,l.filters=[y],p.addChild(l);const m=new PIXI.Graphics,x=Math.max(n.screen.width,n.screen.height)*2;m.beginFill(16777215),m.drawRect(-x/2,-x/2,x,x),m.endFill(),m.beginHole(),m.drawCircle(0,0,300),m.endHole(),m.filters=[new PIXI.BlurFilter(250)];const b=new PIXI.Rectangle(-x/2,-x/2,x,x),I=n.renderer.generateTexture(m,{scaleMode:PIXI.SCALE_MODES.LINEAR,resolution:1,region:b}),R=new PIXI.Sprite(I);R.anchor.set(.5),n.stage.addChild(R),l.mask=R,n.stage.eventMode="static",n.stage.hitArea=n.screen,n.stage.on("pointermove",O=>{const H=O.global;R.position.set(H.x,H.y)}),window.addEventListener("resize",()=>{const O=Math.max(n.screen.width,n.screen.height)*2;m.clear(),m.beginFill(16777215),m.drawRect(-O/2,-O/2,O,O),m.endFill(),m.beginHole(),m.drawCircle(0,0,300),m.endHole(),m.filters=[new PIXI.BlurFilter(250)];const H=new PIXI.Rectangle(-O/2,-O/2,O,O),z=n.renderer.generateTexture(m,{scaleMode:PIXI.SCALE_MODES.LINEAR,resolution:1,region:H});R.texture=z,M(),D()})}const c=-1,a=(S,h,y)=>S+(h-S)*y;function E(){const S=Math.max(0,f.scrollWidth-t.clientWidth),h=Math.max(0,f.scrollHeight-t.clientHeight),y=S?t.scrollLeft/S:0,m=h?t.scrollTop/h:0;return{rx:y,ry:m}}function F(){const S=Math.max(0,(w.width-n.screen.width)/2),h=Math.max(0,(w.height-n.screen.height)/2);return{travelX:S,travelY:h}}function D(){const{rx:S,ry:h}=E(),{travelX:y,travelY:m}=F(),x=c*a(-y,+y,S),b=c*a(-m,+m,h),I=n.screen.width/2+x,R=n.screen.height/2+b;w.x=I,w.y=R,l&&(l.x=I,l.y=R)}let T=!1;t.addEventListener("scroll",()=>{T||(T=!0,requestAnimationFrame(()=>{T=!1,D()}))},{passive:!0}),D();const N=PIXI.Texture.from("https://pixijs.com/assets/pixi-filters/displacement_map_repeat.jpg");N.baseTexture.wrapMode=PIXI.WRAP_MODES.REPEAT;const C=new PIXI.Sprite(N);C.width=n.screen.width*2,C.height=n.screen.height*2,C.x=-n.screen.width/2,C.y=-n.screen.height/2,p.addChild(C);const $=PIXI.Texture.from(j("media/media-nodes/noisy.png")),_=new PIXI.TilingSprite($,n.screen.width,n.screen.height);_.alpha=.2,p.addChild(_);const q=new PIXI.DisplacementFilter(C);q.scale.x=20,q.scale.y=40;let Y=0;n.ticker.add(S=>{(Y++&1)!==1&&(C.x+=.6*S,C.y+=.4*S,C.x>0&&(C.x=-n.screen.width/2),C.y>0&&(C.y=-n.screen.height/2),_.tilePosition.x+=.09*S,_.tilePosition.y+=.05*S)}),window.addEventListener("resize",()=>{M(),_.tileScale.set(n.screen.width/_.texture.width,n.screen.height/_.texture.height),C.width=n.screen.width*2,C.height=n.screen.height*2,C.x=-n.screen.width/2,C.y=-n.screen.height/2,_.width=n.screen.width,_.height=n.screen.height,D()})}const j=e=>`/${String(e).replace(/^\/+/,"")}`;function oe(e,t,{field:f,positions:l,blocks:n,clampCenterToField:p}){const u=document.createElement("div");u.classList.add("pic-el"),u.classList.add("map-item"),u.dataset.id=e.id,u.dataset.name=e.name,u.dataset.link=(e.link||"—").trim(),u.style.display="flex",u.style.justifyContent="center",u.style.alignItems="center",u.style.position="absolute",u.style.left=l[t].x+"px",u.style.top=l[t].y+"px",u.style.transform="translate(-50%, -50%)",e.style&&typeof e.style=="object"&&(e.style.width||e.style.height)||(u.style.width="auto",u.style.height="auto"),e.style&&typeof e.style=="object"&&Object.assign(u.style,e.style);const o=typeof e.url=="string"&&/\.(mp4|webm|ogg)$/i.test(e.url);let s;if(o){const i=document.createElement("video");i.src=e.url,i.muted=!0,i.loop=!0,i.autoplay=!0,i.playsInline=!0,i.preload="metadata",i.style.width="100%",i.style.height="100%",i.style.objectFit="cover",i.style.transition="transform 0.6s ease",i.addEventListener("canplay",()=>{i.play().catch(()=>{})}),s=i}else{const i=document.createElement("img");i.src=e.url,i.alt=e.name||"",i.decoding="async",i.loading="lazy",i.style.width="100%",i.style.height="100%",i.style.objectFit="cover",i.style.transition="transform 0.6s ease",s=i}u.appendChild(s),f.appendChild(u),n[t]=u;const r=()=>p(u,l[t].x,l[t].y);r(),s.tagName==="IMG"?s.complete?r():s.addEventListener("load",r,{once:!0}):s.tagName==="VIDEO"&&(s.readyState>=1?r():s.addEventListener("loadedmetadata",r,{once:!0})),u.addEventListener("mouseenter",()=>{s.style.transform="scale(1.05)"}),u.addEventListener("mouseleave",()=>{s.style.transform="scale(1)"})}function re(e,t,{field:f,positions:l,blocks:n,clampCenterToField:p,config:u}){const o=document.createElement("div");o.classList.add("text-el"),o.classList.add("map-item"),o.style.position="absolute",o.style.left=l[t].x+"px",o.style.top=l[t].y+"px",o.style.transform="translate(-50%, -50%)",o.dataset.id=e.id,o.dataset.name=e.name,o.dataset.link="—",o.innerHTML=`
    <div class="meta-top">
      <span class="title">${e.name}</span>
    </div>
    <div class="text-content">
      ${e.paragraphs.map((d,c)=>`<p ${c===0?'class="active"':""}>${d}</p>`).join("")}
    </div>
    <div class="meta-bottom">
      <span class="counter">1/${e.paragraphs.length}</span>
      <span class="scroll-hint">scroll it</span>
    </div>
  `;let s=0;const r=o.querySelectorAll("p"),i=o.querySelector(".counter");let g=!1;const v=u.text.switchCooldownMs;function w(d){if(g)return;d()&&(g=!0,setTimeout(()=>{g=!1},v))}o.addEventListener("wheel",d=>{d.preventDefault(),d.deltaY>0?w(A):w(B)},{passive:!1});let L=null;const M=u.text.swipeThresholdPx;o.addEventListener("touchstart",d=>{L=d.touches[0].clientY},{passive:!0}),o.addEventListener("touchmove",d=>{if(L==null)return;const c=d.touches[0].clientY-L;Math.abs(c)>M&&d.preventDefault()},{passive:!1}),o.addEventListener("touchend",d=>{if(L==null)return;const c=d.changedTouches[0].clientY-L;Math.abs(c)>M&&(c<0&&w(A),c>0&&w(B)),L=null});function A(){return s<r.length-1?(r[s].classList.remove("active"),r[s].classList.add("exit"),s++,r[s].classList.add("active"),i.textContent=`${s+1}/${r.length}`,setTimeout(()=>{r.forEach(d=>d.classList.remove("exit"))},u.text.exitClassDurationMs),!0):!1}function B(){return s>0?(r[s].classList.remove("active"),r.forEach(d=>d.classList.remove("exit")),s--,r[s].classList.add("active"),i.textContent=`${s+1}/${r.length}`,!0):!1}f.appendChild(o),n[t]=o,p(o,l[t].x,l[t].y)}const X={scaleFactor:9,mobile:{userAgentRe:/Mobi|Android|iPhone|iPad|iPod/i,widthBoost:1.8,heightShrink:.9},edgeMarginVw:5,minPaddingPx:10,gridOversample:1,cell:{inset:.3,jitter:.6},text:{switchCooldownMs:1e3,swipeThresholdPx:50,exitClassDurationMs:600},foundThreshold:.5};async function ce(){const t=await(await fetch("data/data.json")).json(),f=window.innerWidth,l=window.innerHeight,n=X.scaleFactor,p=X.mobile.userAgentRe.test(navigator.userAgent),u=p?X.mobile.widthBoost:1,o=p?X.mobile.heightShrink:1,s=f*n*u,r=l*n*o,i=X.edgeMarginVw,g=window.innerWidth*(i/100),v=document.getElementById("main-field");v.style.width=s+"px",v.style.height=r+"px";const w=t.length,L=Math.max(g,X.minPaddingPx),M=Math.max(g,X.minPaddingPx),A=Math.max(1,s-2*L),B=Math.max(1,r-2*M),d=[];(function(){const y=X.gridOversample,m=Math.ceil(w*y),x=A/B;let b=Math.max(1,Math.round(Math.sqrt(m/x))),I=Math.max(1,Math.ceil(m/b));for(;b*I<m;){const P=(I+1)*b-m,k=I*(b+1)-m;P<=k?I++:b++}const R=A/I,O=B/b,H=X.cell.inset,z=X.cell.jitter,W=[];for(let P=0;P<b;P++)for(let k=0;k<I;k++){const Q=L+k*R,J=M+P*O,Z=Q+R*H,ee=J+O*H,te=R*(1-2*H),ne=O*(1-2*H),se=Z+te*(.5+(Math.random()-.5)*2*z),ie=ee+ne*(.5+(Math.random()-.5)*2*z);W.push({x:Math.min(L+A,Math.max(L,se)),y:Math.min(M+B,Math.max(M,ie))})}for(let P=W.length-1;P>0;P--){const k=Math.floor(Math.random()*(P+1));[W[P],W[k]]=[W[k],W[P]]}d.length=0;for(let P=0;P<w&&P<W.length;P++)d.push(W[P])})(),d.length<w&&console.warn(`Разместили ${d.length}/${w}. Увеличьте CONFIG.scaleFactor или скорректируйте параметры сетки (CONFIG.gridOversample / CONFIG.cell).`);function c(h){for(let y=h.length-1;y>0;y--){const m=Math.floor(Math.random()*(y+1));[h[y],h[m]]=[h[m],h[y]]}}c(d);const a=d.map(h=>({nx:h.x/s,ny:h.y/r})),E=[];function F(h,y,m){const x=h.getBoundingClientRect(),b=x.width/2,I=x.height/2,R=Math.min(s-g-b,Math.max(g+b,0)),O=Math.max(g+b,Math.min(s-g-b,s)),H=Math.min(r-g-I,Math.max(g+I,0)),z=Math.max(g+I,Math.min(r-g-I,r)),W=Math.min(O,Math.max(R,y)),P=Math.min(z,Math.max(H,m));h.style.left=W+"px",h.style.top=P+"px"}function D(h,y){v.style.width=h+"px",v.style.height=y+"px",E.forEach((m,x)=>{if(!m)return;const b=a[x].nx*h,I=a[x].ny*y;m.style.left=b+"px",m.style.top=I+"px",F(m,b,I)})}let T=!1;window.addEventListener("resize",()=>{T||(T=!0,requestAnimationFrame(()=>{T=!1;const h=window.innerWidth,y=window.innerHeight,m=h*n*(p?u:1),x=y*n*(p?o:1);D(m,x)}))}),t.forEach((h,y)=>{if(!d[y]){console.warn(`Пропуск элемента #${y} (${h.name||h.id}) — нет позиции`);return}h.type==="text-el"?re(h,y,{field:v,positions:d,blocks:E,clampCenterToField:F,config:X}):oe(h,y,{field:v,positions:d,blocks:E,clampCenterToField:F})});const N=document.getElementById("main-field-wrapper"),C=document.querySelectorAll(".map-item"),$=new Set,_=document.getElementById("found-span"),q=document.getElementById("node-name"),Y=document.getElementById("node-id-span"),S=new IntersectionObserver(h=>{h.forEach(y=>{const m=y.target,x=m.dataset.id,b=document.getElementById("node-link");if(x&&y.intersectionRatio>=.5){q&&(q.textContent=m.dataset.name||""),Y&&(Y.textContent=x),$.has(x)||($.add(x),_&&(_.textContent=String($.size)));const I=m.dataset.link||"";b&&(I?(b.href=I,b.textContent=I,b.target="_blank",b.rel="noopener noreferrer",b.style.pointerEvents="auto",b.style.opacity="1"):(b.removeAttribute("href"),b.textContent="",b.removeAttribute("target"),b.removeAttribute("rel"),b.style.pointerEvents="none",b.style.opacity="0.6"))}})},{root:N,threshold:[X.foundThreshold]});C.forEach(h=>S.observe(h))}function le(){const e=document.getElementById("main-field-wrapper"),t=document.getElementById("main-field");if(!e||!t)return;let f=!1,l=!1,n=0,p=0,u=0,o=0;e.addEventListener("pointerdown",r=>{r.pointerType!=="mouse"||r.button!==0||(f=!0,l=!1,n=r.clientX,p=r.clientY,u=e.scrollLeft,o=e.scrollTop,e.setPointerCapture?.(r.pointerId))}),e.addEventListener("pointermove",r=>{if(!f)return;const i=r.clientX-n,g=r.clientY-p;!l&&Math.abs(i)+Math.abs(g)>3&&(l=!0,e.classList.add("dragging")),l&&(e.scrollLeft=u-i,e.scrollTop=o-g,r.preventDefault())});const s=r=>{f&&(f=!1,l&&(e.classList.remove("dragging"),l=!1),e.releasePointerCapture?.(r.pointerId))};e.addEventListener("pointerup",s),e.addEventListener("pointercancel",s),e.addEventListener("pointerleave",s)}function de(){const e=document.getElementById("main-field-wrapper"),t=document.getElementById("main-field");if(!e||!t)return;const f=new IntersectionObserver(i=>{for(const g of i)g.intersectionRatio>=.5?g.target.classList.add("in-view"):g.target.classList.remove("in-view")},{root:e,threshold:[0,.4,1]}),l=i=>{i.classList.contains("reveal")||i.classList.add("reveal"),f.observe(i)};document.querySelectorAll(".map-item").forEach(l),new MutationObserver(i=>{for(const g of i)g.addedNodes.forEach(v=>{v instanceof HTMLElement&&(v.matches(".map-item")&&l(v),v.querySelectorAll?.(".map-item").forEach(l))})}).observe(t,{childList:!0,subtree:!0});const p=document.getElementById("main-field-wrapper");if(!p||!t)return;const u=()=>{const i=Math.max(0,t.scrollWidth-p.clientWidth),g=Math.max(0,t.scrollHeight-p.clientHeight);return{left:i/2,top:g/2}},o=(i="auto")=>{const{left:g,top:v}=u();p.scrollTo({left:g,top:v,behavior:i}),p.dispatchEvent(new Event("scroll",{bubbles:!1}))};let s=!1;const r=()=>s?void 0:t.scrollWidth>p.clientWidth+100&&t.scrollHeight>p.clientHeight+100?(s=!0,o("auto"),!0):!1;requestAnimationFrame(()=>{if(r())return;const i=new ResizeObserver(()=>{r()&&i.disconnect()});i.observe(t),i.observe(p);const g=performance.now(),v=()=>{r()||performance.now()-g>2e3||requestAnimationFrame(v)};v()}),window.addEventListener("load",()=>{s||o("auto")})}function pe(){const e=document.getElementById("questions"),t=document.getElementById("blending-explenation"),f=document.querySelector("html"),l=document.getElementById("init-span");if(!e||!t)return;(window.devicePixelRatio>2||navigator.hardwareConcurrency<=4)&&document.documentElement.classList.add("low-perf"),t.style.opacity="0";const n=0;let p=!1;const u=()=>{t.classList.remove("blend-anim-in","blend-anim-out"),f.classList.remove("pixi-anim-in","pixi-anim-out")},o=()=>{p||(u(),f.style.filter="invert(0)",t.classList.remove("blend-hidden"),t.classList.add("blend-anim-in"),f.classList.add("pixi-anim-in"),t.addEventListener("animationend",function r(i){i.animationName==="blendFadeIn"&&(t.removeEventListener("animationend",r),t.classList.remove("blend-anim-in"),f.classList.remove("pixi-anim-in"),t.classList.add("blend-open"),f.style.filter="invert(1)",t.style.opacity="1",l&&(l.style.transition||(l.style.transition="opacity 300ms ease"),l.style.opacity="0"),p=!0)},{once:!0}))},s=(r=n)=>{if(!p)return;u();const i=()=>{t.classList.add("blend-anim-out"),f.classList.add("pixi-anim-out"),t.addEventListener("animationend",function g(v){v.animationName==="blendFadeOut"&&(t.removeEventListener("animationend",g),t.classList.remove("blend-anim-out"),f.classList.remove("pixi-anim-out"),t.classList.remove("blend-open"),t.classList.add("blend-hidden"),t.style.opacity="0",f.style.filter="",l&&(l.style.transition||(l.style.transition="opacity 300ms ease"),l.style.opacity="1"),p=!1)},{once:!0})};r>0?setTimeout(i,r):i()};e.addEventListener("click",r=>{r.preventDefault(),p?s():o()})}function ue(){const e={text:{switchCooldownMs:1e3,swipeThresholdPx:50,exitClassDurationMs:600},styles:{textColor:"#000",zIndex:"2001"}},t=document.getElementById("inition-field");if(!t)return;const f=()=>{t.classList.contains("closing")||(t.classList.add("closing"),t.addEventListener("transitionend",()=>{t.style.display="none"},{once:!0}))},l={name:"инициализация",paragraphs:["«В&nbsp;целях соблюдения академических норм они [студенты] обязаны выделять результаты своей деятельности, при&nbsp;реализации которой был использован ИИ, указывая характер и&nbsp;объем работ, выполненных с&nbsp;его помощью. В&nbsp;противном случае это рассматривается как нарушение академических норм, что может повлечь за&nbsp;собой дисциплинарное взыскание» — пишется в&nbsp;справочнике учебного процесса НИУ ВШЭ.","Было ли выписано хотя бы одно дисциплинарное взыскание на&nbsp;основании отсутствия указания об&nbsp;использовании студентом языковой модели? Преподаватели, вероятно, знают, насколько много студенческих текстов на&nbsp;самом деле написано не&nbsp;студентами — если не&nbsp;знают, то&nbsp;чувствуют.","За&nbsp;последний год 85 % (а&nbsp;то и&nbsp;больше) всех студенческих текстов, которые я&nbsp;читала (включая тексты дизайн-проектов, визуальных исследований, эссе и&nbsp;в&nbsp;целом любых заданий, где можно было бы&nbsp;сдать нечто, напоминающее текст), были написаны нейросетями. Говорил ли об&nbsp;этом хоть кто-то при&nbsp;его сдаче? Нет. По&nbsp;крайней мере, не преподавателю, а&nbsp;мне — одногруппнику, у&nbsp;которого явно нет намерений никого «сдать».","Пока что НИУ ВШЭ даже на&nbsp;первый взгляд не&nbsp;справляется с&nbsp;выполнением своих предписаний в&nbsp;справочнике учебного процесса, ведь полагаться в&nbsp;вопросе «авторства» (термин существующей традиции академии, все еще используемой ею) можно разве что на&nbsp;честность студента, которой, увы (судя по&nbsp;тому, что творится вокруг), у&nbsp;него нет.","Учебный процесс столкнулся с&nbsp;чем-то совершенно новым, и&nbsp;составители «академических норм» и&nbsp;«справочника учебного процесса» пока что вообще не&nbsp;понимают, как действовать. Бакалавриат можно закончить, не&nbsp;написав ни&nbsp;строчки текста самостоятельно — многие мои одногруппники упорно пытаются&nbsp;выполнить такой челлендж и&nbsp;пока что идут очень успешно — это пугает и&nbsp;вдохновляет одновременно.","Это определённо требует обсуждения, постановки совершенно новых вопросов, пересмотра уже существующих, но&nbsp;более не&nbsp;работающих концепций, обновления старых понятий и&nbsp;логики, которая уже не&nbsp;актуальна. Времени на&nbsp;это обсуждение у&nbsp;нас нет: темпы ежегодного роста способностей ИИ огромные и&nbsp;останавливаться не&nbsp;планируют.","В&nbsp;этом обсуждении придётся дойти и&nbsp;до&nbsp;новых «академических норм», хотя это будет далеко не первым шагом. Этот лонгрид — частичка в&nbsp;потоке этого бесконечного обсуждения, попытка собрать и&nbsp;использовать те&nbsp;концепции, которые, кажется, всё ещё работают в&nbsp;законах нового мира. Попытка найти что-то уже знакомое, чтобы стоять на&nbsp;теоретической почве было не&nbsp;так&nbsp;шатко.","Концепции, которыми я пользуюсь здесь, в&nbsp;основном будут взяты из&nbsp;методологии постструктурализма — большинство из&nbsp;них не просто пережили появление языковых моделей, но&nbsp;были ими обновлены / доказаны / выделены. Возможно, меня может куда-то занести, ноя&nbsp;буду стараться следовать обозначенному плану.","А теперь задачка. Был ли&nbsp;этот текст написан человеком? Если да,&nbsp;то&nbsp;какая его часть? Как вы&nbsp;это поняли?"]};function n(o){const s=document.createElement("div");s.classList.add("text-el"),s.classList.add("init-item"),s.style.position="absolute",s.style.left="50vw",s.style.top="50vh",s.style.transform="translate(-50%, -50%)",s.innerHTML=`
    <div class="meta-top">
      <span class="title">${o.name}</span>
    </div>
    <div class="text-content">
      ${o.paragraphs.map((a,E)=>`<p ${E===0?'class="active"':""}>${a}</p>`).join("")}
    </div>
    <div class="meta-bottom">
      <span class="counter">1/${o.paragraphs.length}</span>
      <span class="scroll-hint">scroll it</span>
    </div>  `;let r=0;const i=s.querySelectorAll("p"),g=s.querySelector(".counter");let v=!1;const w=e.text.switchCooldownMs;function L(a){if(v)return;a()&&(v=!0,setTimeout(()=>{v=!1},w))}s.addEventListener("wheel",a=>{a.preventDefault(),a.deltaY>0?L(B):L(d)},{passive:!1});let M=null;const A=e.text.swipeThresholdPx;s.addEventListener("touchstart",a=>{M=a.touches[0].clientY},{passive:!0}),s.addEventListener("touchmove",a=>{if(M==null)return;const E=a.touches[0].clientY-M;Math.abs(E)>A&&a.preventDefault()},{passive:!1}),s.addEventListener("touchend",a=>{if(M==null)return;const E=a.changedTouches[0].clientY-M;Math.abs(E)>A&&(E<0&&L(B),E>0&&L(d)),M=null});function B(){return r<i.length-1?(i[r].classList.remove("active"),i[r].classList.add("exit"),r++,i[r].classList.add("active"),g.textContent=`${r+1}/${i.length}`,setTimeout(()=>{i.forEach(a=>a.classList.remove("exit"))},e.text.exitClassDurationMs),!0):!1}function d(){return r>0?(i[r].classList.remove("active"),i.forEach(a=>a.classList.remove("exit")),r--,i[r].classList.add("active"),g.textContent=`${r+1}/${i.length}`,!0):!1}const c=s.querySelector(".meta-top");if(c){const a=document.createElement("span");a.className="close-init",a.setAttribute("role","button"),a.setAttribute("aria-label","закрыть"),a.textContent="×",c.appendChild(a),a.addEventListener("click",E=>{E.preventDefault(),E.stopPropagation(),f()})}t.appendChild(s),s.style.setProperty("color",e.styles.textColor,"important"),s.style.zIndex=e.styles.zIndex}n(l);const p=()=>{t.style.display!=="none"&&!t.classList.contains("closing")||(t.querySelector(".text-el")||n(l),t.style.display="block",t.classList.add("closing"),requestAnimationFrame(()=>{t.classList.remove("closing")}))},u=document.getElementById("init-span");u&&u.addEventListener("click",o=>{o.preventDefault(),p()})}function me(){const e={images:{globalKey:"PICS",fallback:["media/body-parts/ar.webp","media/body-parts/original_17c39b5ebfce6f63b622346d966b34af.png","media/body-parts/original_1c300758673bb2ee8924571c026759f9.png","media/body-parts/original_1ce340ea95ce6d0563f89516c962eec9.png","media/body-parts/original_28562d4eccd70a092c4cb30e55b127c3.png","media/body-parts/original_2b1485cbb03ce46dfbece20f7276832d.png","media/body-parts/original_312f8af9f2526694cafa3771878119e4.png","media/body-parts/original_51625c7960e1a7352fa89e0e3af7dd42.png","media/body-parts/original_5a99021cb90714869e7cc137ddd22399.png","media/body-parts/original_5eb9627659ec24f59495d63c19a40018.png","media/body-parts/original_6397cdfea5ad82371d31c34c47f7f46c.png","media/body-parts/original_6c9f5a2bd1ba0be3c780d158c19d483d.png","media/body-parts/original_871653cae6f9aa282f4cfde634ee84f2.png","media/body-parts/original_91b46e8287a9abf6c95782d3cb3152b2.png","media/body-parts/original_9f050f313cabc8e0f726c561f82a7640.png","media/body-parts/original_a4c9255738bb3b4397b0261171264e7c.png","media/body-parts/original_b8755ea1b592d62b999df170a82b4a19.png","media/body-parts/original_d217e6a9a2ad80c3fe16a6e5c1a7fd28.png","media/body-parts/original_dbc5c8a6eeae6710fb5a398abcd4adad.png","media/body-parts/original_de4a16120dd519bd604013775f828464.png","media/body-parts/original_e34b08a5d5957be5d2b32e976b2ca1ae.png","media/body-parts/original_e8ab5d1c14f7d75ce10ac5170fb868ab.png","media/body-parts/ssdv.png","media/body-parts/svczx.png"]},maxConcurrent:1,spawnDelayMs:[1800,3400],offscreenMarginPx:120,sizeVw:[60,110],initialOpacity:[.1,.2],durationS:[16,32],img:{className:"floating-img",decoding:"async",loading:"eager",draggable:!1,position:"absolute",pointerEvents:"none",mixBlendMode:"color-dodge",willChange:"transform, opacity",height:"auto"},opacityAnim:{base:.1,amplitude:.3}},t=document.getElementById("main-wrapper");if(!t)return;const f=window[e.images.globalKey],l=Array.isArray(f)&&f.length?f:e.images.fallback,n=new Set;let p=0,u=0;function o(d,c){return d+Math.random()*(c-d)}function s(d,c){return Math.floor(o(d,c))}function r(d){return d[s(0,d.length)]}function i(){return{w:window.innerWidth,h:window.innerHeight}}function g(d){const c=new Image;return c.src=d,c.className=e.img.className,c.decoding=e.img.decoding,c.loading=e.img.loading,c.draggable=e.img.draggable,c.style.position=e.img.position,c.style.pointerEvents=e.img.pointerEvents,c.style.mixBlendMode=e.img.mixBlendMode,c.style.willChange=e.img.willChange,c.style.opacity=String(o(e.initialOpacity[0],e.initialOpacity[1])),c.style.width=`${o(e.sizeVw[0],e.sizeVw[1]).toFixed(1)}vw`,c.style.height=e.img.height,c}function v(){const{w:d,h:c}=i(),a=e.offscreenMarginPx,E=s(0,4);let F,D,T,N;switch(E){case 0:F=-a,D=o(-a,c+a),T=d+a,N=o(-a,c+a);break;case 1:F=d+a,D=o(-a,c+a),T=-a,N=o(-a,c+a);break;case 2:F=o(-a,d+a),D=-a,T=o(-a,d+a),N=c+a;break;default:F=o(-a,d+a),D=c+a,T=o(-a,d+a),N=-a;break}return T+=o(-a*.5,a*.5),N+=o(-a*.5,a*.5),{x0:F,y0:D,x1:T,y1:N}}function w(){if(n.size>=e.maxConcurrent)return;const d=r(l),c=g(d);t.appendChild(c);const{x0:a,y0:E,x1:F,y1:D}=v(),T=performance.now(),N=o(e.durationS[0],e.durationS[1])*1e3;let C=0,$=0;const _=()=>{const Y=c.getBoundingClientRect();C=Y.width*.5,$=Y.height*.5};c.onload=_,c.complete&&_();const q={el:c,start:T,dur:N,x0:a,y0:E,x1:F,y1:D,dead:!1,get offsetX(){return C},get offsetY(){return $}};n.add(q)}function L(d){n.size&&n.forEach(c=>{if(c.dead)return;const a=Math.min(1,(d-c.start)/c.dur),E=c.x0+(c.x1-c.x0)*a-(c.offsetX||0),F=c.y0+(c.y1-c.y0)*a-(c.offsetY||0);c.el.style.transform=`translate3d(${E}px, ${F}px, 0)`,c.el.style.opacity=String(e.opacityAnim.base+e.opacityAnim.amplitude*Math.sin(Math.PI*Math.min(a,1))),a>=1&&(c.dead=!0,c.el.remove(),n.delete(c))}),p=requestAnimationFrame(L)}function M(){clearTimeout(u);const d=s(e.spawnDelayMs[0],e.spawnDelayMs[1]);u=setTimeout(()=>{n.size<e.maxConcurrent&&w(),M()},d)}function A(){t.style.display="block",p||(p=requestAnimationFrame(L)),M()}function B(){clearTimeout(u),cancelAnimationFrame(p),p=0,n.forEach(d=>d.el.remove()),n.clear()}l&&l.length&&A(),window.FloatingImages={start:A,stop:B},document.addEventListener("visibilitychange",()=>{document.hidden?B():A()})}function fe(){const e=document.documentElement,t=document.getElementById("inition-field"),f=document.getElementById("init-span"),l=document.getElementById("questions"),n=o=>{e.style.filter=`invert(${o})`},p=()=>t?window.getComputedStyle(t).display!=="none"&&!t.classList.contains("closing"):!1,u=()=>{const o=p();n(o?1:0),l&&(l.style.display=o?"none":"")};u(),t&&t.addEventListener("click",o=>{o.target.closest(".close-init")&&n(0)}),f&&f.addEventListener("click",()=>{n(1),l&&(l.style.display="none")}),t&&new MutationObserver(()=>{u()}).observe(t,{attributes:!0,attributeFilter:["class","style"]})}const G={id:"loading-screen",hiddenClass:"loading-hidden",fadeMs:500,maxWaitMs:1500};function he(e){return new Promise(t=>setTimeout(t,e))}function V(){return new Promise(e=>requestAnimationFrame(()=>e()))}function K(){return typeof performance<"u"?performance.now():Date.now()}function U(){return document.getElementById(G.id)}function ge(){const e=document.getElementById("main-field");return!e||!e.children.length?!1:!!e.querySelector(".map-item")}function ye(){const e=document.getElementById("pixi-container-waves-blur");if(!e)return!1;const t=e.querySelector("canvas");if(!t)return!1;const f=t.getBoundingClientRect();return f.width>0&&f.height>0}function be(){const e=document.getElementById("main-wrapper")||document,t=e.querySelectorAll(".map-item img");for(const l of t)if(!l.complete)return!1;const f=e.querySelectorAll(".map-item video");for(const l of f)if(l.readyState<1)return!1;return!0}async function ve(e){document.readyState!=="complete"&&(await new Promise(t=>{window.addEventListener("load",t,{once:!0})}),K()>e)}async function we(e){for(;K()<e&&!(ge()&&ye()&&be());)await V();await V(),await V()}function xe(){const e=U();e&&(e.classList.add(G.hiddenClass),window.setTimeout(()=>e.remove(),G.fadeMs+50))}async function Ee(){if(!U())return;const t=K()+G.maxWaitMs;await Promise.race([ve(t),he(G.maxWaitMs)]),await we(t),xe()}window.addEventListener("load",ae);document.addEventListener("DOMContentLoaded",()=>{const e=ce();de(),le(),pe(),ue(),me(),fe(),e.finally(()=>{Ee()})});
